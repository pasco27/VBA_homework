## Having a hard time saving the VBA file
## So I decided to copy my code into an Xcode file
## Grader can now see my early attempts here
## These early attempts were made based off the credit card example


Sub VBA_HW_r0()

' Set an initial variable for holding each individual ticker
  Dim ticker As String
 
' Define the firstRow / lastRow variable for calculating the change in stock price
  'Dim firstRow As Range
  'Dim lastRow As Range

' Set an initial variables for holding opening and closing prices
  Dim yearly_open As Double
  Dim yearly_close As Double
  Dim yearly_change As Double
  Dim yearly_percent_change As Double
 
' Set an intial variouable for holding the total volume
  Dim yearly_volume As Double
  yearly_volume = 0

' Keep track of the location for each ticker in the summary table
  Dim Summary_Table_Row As Integer
  Summary_Table_Row = 2
 
' Loop through all stock records
  For i = 2 To 70926
   
' Checker for the next stock ticker
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

        ' Set ticker as item to be checked/stored
        ticker = Cells(i, 1).Value
       
        ' State ticker yearly open --- how I pick only particularly the first one?
        yearly_open = Cells(i, 3)
       
        ' State ticker yearly close --- how do I pick particularly the last one?
        yearly_close = Cells(Rows.Count, 6).End(xlUp)
        '---something is not quite right here but I'm close
 
       
        'a lot of this is stuff I don't know will work or not.-- i'm just documenting at this point
         'yearly_close = Cells(i, 3).Offset(261, 3).Select
        'lastRow = Cells(Rows.Count, "F").End(xlUp).Row
        'firstRow = .Range("C" & .Rows.Count).End(xlDown).Row
        'lastRow = .Range("F" & .Rows.Count).End(xlUp).Row
        'lastRow = ThisWorkbook.??Worksheets(SheetName)??.Cells(Rows.Count, 1).End(xlUp).Row

        ' State yearly change
        yearly_change = yearly_close - yearly_open
       
        ' do the math for yearly percentchange
        yearly_percent_change = ((yearly_close - yearly_open) / yearly_open) * 100
       
        ' Setup counter for yearly total volume
        yearly_volume = yearly_volume + Cells(i, 7).Value
       

        ' Print the ticker in the Summary Tablev and its header
        Range("I" & Summary_Table_Row).Value = ticker
        Cells(1, 9).Value = "Ticker"

        ' Print the yearly change to the Summary Table and its header
        Range("J" & Summary_Table_Row).Value = yearly_change
        Cells(1, 10) = "Yearly $ Change"
       
        ' Print the yearly percentage change to the Summary Table and its header
        Range("K" & Summary_Table_Row).Value = yearly_percent_change
        Cells(1, 11) = "Yearly % Change"
       
        ' Print the yearly total volume to the Summary Table and its header
        Range("L" & Summary_Table_Row).Value = yearly_volume
        Cells(1, 12) = "Total Volume"

        ' Add one to the summary table row
        Summary_Table_Row = Summary_Table_Row + 1

        ' Reset the yearly volume
        yearly_volume = 0

   
    ' If the cell immediately following a row is the same ticker...
        Else

            yearly_volume = yearly_volume + Cells(i, 7).Value
       
           
        End If
       
    Next i

End Sub
